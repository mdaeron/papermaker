%!TEX root = HDR.tex

%%%%%%%%%%%%%%%% FONTS %%%%%%%%%%%%%%%%
\usepackage{amsmath} % required by mathspec
\usepackage{mathspec} % includes fontspec

	% undo wrong change made by mathspec (cf link below)
	\makeatletter
	\let\RequirePackage\original@RequirePackage
	\let\usepackage\RequirePackage
	\makeatother
	% https://tex.stackexchange.com/questions/85696/what-causes-this-strange-interaction-between-glossaries-and-amsmath

\setmainfont[%
	WordSpace=1.25,
	]{STIX Two Text}[]

%\setsansfont[%
%	WordSpace=1.5,
%	Scale=MatchLowercase,%
%	UprightFont = FiraGO Regular,%
%	BoldFont = FiraGO Medium,%
%	ItalicFont = FiraGO Italic,%
%	BoldItalicFont = FiraGO Medium Italic%
%	]{FiraGO}

\setsansfont[%
	WordSpace=1.25,
	Scale=MatchLowercase,%
	]{Source Sans 3}

\setmonofont[%
	WordSpace=1.25,
	Scale=MatchLowercase,%
	UprightFont = JetBrains Mono Regular,%
	BoldFont = JetBrains Mono Bold,%
	ItalicFont = JetBrains Mono Italic,%
	BoldItalicFont = JetBrains Mono Bold Italic,%
%	Color = 008800,%
	]{JetBrains Mono}

%%%%%%%%%%%%%%%% MATHS %%%%%%%%%%%%%%%%
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{nicefrac}
\setmathfont(Digits,Latin,Greek)[
	UprightFont    = STIX Two Text,
	BoldFont       = STIX Two Text Bold,
	ItalicFont     = STIX Two Text Italic,
	BoldItalicFont = STIX Two Text Bold Italic,
	Numbers        = Lining
	]{STIX Two Text}
	
\setmathrm[
	Scale=MatchLowercase,%
	UprightFont    = STIX Two Text,
	BoldFont       = STIX Two Text Bold,
	ItalicFont     = STIX Two Text Italic,
	BoldItalicFont = STIX Two Text Bold Italic,
	Numbers        = Lining
	]{STIX Two Text}
%\setmathsf[
%	Scale=MatchLowercase,%
%	]{Fira Math}

	% additional mathspec corrections (cf link below)
	\makeatletter
	\ernewcommand\eu@MathPunctuation@symfont{Latin:m:n}
	\DeclareMathSymbol{,}{\mathpunct}{\eu@MathPunctuation@symfont}{`,}
	\DeclareMathSymbol{.}{\mathord}{\eu@MathPunctuation@symfont}{`.}
	\DeclareMathSymbol{<}{\mathrel}{\eu@MathPunctuation@symfont}{`<}
	\DeclareMathSymbol{>}{\mathrel}{\eu@MathPunctuation@symfont}{`>}
	\DeclareMathSymbol{/}{\mathord}{\eu@MathPunctuation@symfont}{`/}
	\DeclareMathSymbol{;}{\mathpunct}{\eu@MathPunctuation@symfont}{`;}
	\XeTeXDeclareMathSymbol{^^^^2026}{\mathinner}{\eu@MathPunctuation@symfont}{"2026}[\mathellipsis]
	\makeatother
	% https://tex.stackexchange.com/questions/74140/xetex-mathspec-punctuation-issue

%%%%%%%%%%%%%%%% TYPOGRAPHY %%%%%%%%%%%%%%%%
\usepackage[stretch=10]{microtype}
\usepackage[defaultlines=2,all]{nowidow}

\usepackage{etoolbox}
\makeatletter
\preto{\@verbatim}{\topsep=1ex \partopsep=1ex \color[rgb]{.3,.3,.3}}
\makeatother